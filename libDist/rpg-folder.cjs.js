"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const r=require("@sigureya/rpgtypes"),B=t=>[null,...t],m=(t,a,n)=>a.endsWith(`${t.sep}${r.FOLDER_DATA}`)?t.resolve(a,n):t.resolve(a,r.FOLDER_DATA,n),G=(t,a)=>{if(Array.isArray(t))return t.filter(n=>a(n));throw new Error("Invalid data format")},c=async(t,a,n,e=2)=>{const o=B(n);return t.writeFile(a,JSON.stringify(o,null,e),"utf-8")},i=async(t,a,n)=>{const e=await t.readFile(a,"utf-8"),o=JSON.parse(e);return G(o,n)},A=(t,a)=>m(t,a,r.FILENAME_ACTORS),p=(t,a,n,e,o=2)=>{const s=A(t,n);return c(a,s,e,o)},d=async(t,a,n)=>{const e=A(t,n);return i(a,e,r.isDataActor)},R=(t,a)=>m(t,a,r.FILENAME_ARMORS),v=(t,a,n,e,o=2)=>{const s=R(t,n);return c(a,s,e,o)},C=async(t,a,n)=>{const e=R(t,n);return i(a,e,r.isDataArmor)},E=(t,a)=>m(t,a,r.FILENAME_CLASSES),N=(t,a,n,e,o=2)=>{const s=E(t,n);return c(a,s,e,o)},M=async(t,a,n)=>{const e=E(t,n);return i(a,e,r.isDataClass)},S=(t,a)=>m(t,a,r.FILENAME_ENEMIES),h=(t,a,n,e,o=2)=>{const s=S(t,n);return c(a,s,e,o)},O=async(t,a,n)=>{const e=S(t,n);return i(a,e,r.isDataEnemy)},w=(t,a)=>m(t,a,r.FILENAME_ITEMS),P=(t,a,n,e,o=2)=>{const s=w(t,n);return c(a,s,e,o)},k=async(t,a,n)=>{const e=w(t,n);return i(a,e,r.isDataItem)},z=(t,a)=>m(t,a,r.FILENAME_SKILLS),g=(t,a,n,e,o=2)=>{const s=z(t,n);return c(a,s,e,o)},W=async(t,a,n)=>{const e=z(t,n);return i(a,e,r.isDataSkill)},y=(t,a)=>m(t,a,r.FILENAME_STATES),f=(t,a,n,e,o=2)=>{const s=y(t,n);return c(a,s,e,o)},j=async(t,a,n)=>{const e=y(t,n);return i(a,e,r.isDataState)},I=(t,a)=>m(t,a,r.FILENAME_WEAPONS),J=(t,a,n,e,o=2)=>{const s=I(t,n);return c(a,s,e,o)},$=async(t,a,n)=>{const e=I(t,n);return i(a,e,r.isDataWeapon)},Q=t=>typeof t=="object"&&t!==null&&"id"in t&&typeof t.id=="number",F=(t,a)=>m(t,a,r.FILENAME_TROOPS),U=(t,a,n,e,o=2)=>{const s=F(t,n);return c(a,s,e,o)},x=async(t,a,n)=>{const e=F(t,n);return i(a,e,Q)},X=t=>!!t&&typeof t=="object"&&"id"in t,_=(t,a)=>m(t,a,r.FILENAME_COMMON_EVENTS),Z=(t,a,n,e,o=2)=>{const s=_(t,n);return c(a,s,e,o)},H=async(t,a,n)=>{const e=_(t,n);return i(a,e,X)},T=(t,a)=>m(t,a,r.FILENAME_MAP_INFOS),L=(t,a,n,e,o=2)=>{const s=T(t,n);return c(a,s,e,o)},K=async(t,a,n)=>{const e=T(t,n);return i(a,e,r.isDataMapInfo)},V=t=>t.startsWith("Map")&&t.endsWith(".json"),b=async(t,a)=>(await t.readdir(a,{withFileTypes:!0})).filter(n=>n.isFile()&&V(n.name)),tt=t=>`Map${String(t).padStart(3,"0")}.json`,q=(t,a,n)=>{const e=tt(n);return{filePath:t.resolve(a,e),fileName:e}},at=t=>r.makeMapData(t),Y=async(t,a,n,e)=>{const{filePath:o,fileName:s}=q(a,n,e.id);try{const l=await t.readFile(o,"utf-8"),u=at(JSON.parse(l));return{filename:s,map:u,editingName:e.name}}catch{return{filename:s,editingName:e.name,map:void 0}}},et=async(t,a,n,e,o)=>(o??await K(a,t,n)).filter(l=>!!l&&r.isDataMapInfo(l)).map(async l=>{const u=await Y(t,a,n,l);return e(u)}),nt=async(t,a,n,e)=>({actor:e.actor?e.actor(await d(a,t,n),r.SRC_DATA_ACTOR):void 0,armor:e.armor?e.armor(await C(a,t,n),r.SRC_DATA_ARMOR):void 0,enemy:e.enemy?e.enemy(await O(a,t,n),r.SRC_DATA_ENEMY):void 0,class:e.class?e.class(await M(a,t,n),r.SRC_DATA_CLASS):void 0,item:e.item?e.item(await k(a,t,n),r.SRC_DATA_ITEMS):void 0,skill:e.skill?e.skill(await W(a,t,n),r.SRC_DATA_SKILL):void 0,state:e.state?e.state(await j(a,t,n),r.SRC_DATA_STATE):void 0,weapon:e.weapon?e.weapon(await $(a,t,n),r.SRC_DATA_WEAPON):void 0,troop:e.troop?e.troop(await x(a,t,n),r.SRC_DATA_TROOP):void 0,commonEvent:e.commonEvent?e.commonEvent(await H(a,t,n),r.SRC_DATA_COMMON_EVNET):void 0}),D=t=>{try{return t()}catch{return Promise.resolve()}},rt=async(t,a,n,e)=>Promise.all([D(()=>p(a,t,n,e.actors)),D(()=>h(a,t,n,e.enemies)),D(()=>v(a,t,n,e.armors)),D(()=>J(a,t,n,e.weapons)),D(()=>N(a,t,n,e.classes)),D(()=>P(a,t,n,e.items)),D(()=>g(a,t,n,e.skills)),D(()=>f(a,t,n,e.states))]);exports.dispatchHandlers=nt;exports.ensureActorDataPath=A;exports.ensureArmorDataPath=R;exports.ensureClassDataPath=E;exports.ensureCommonEventDataPath=_;exports.ensureEnemyDataPath=S;exports.ensureItemDataPath=w;exports.ensureMapInfoDataPath=T;exports.ensureSkillDataPath=z;exports.ensureStateDataPath=y;exports.ensureTroopDataPath=F;exports.ensureWeaponDataPath=I;exports.isMapFileName=V;exports.listupMapFiles=b;exports.mappingAllMapFiles=et;exports.readMapFileFromInfo=Y;exports.readRmmzActorData=d;exports.readRmmzArmorData=C;exports.readRmmzClassData=M;exports.readRmmzCommonEventData=H;exports.readRmmzEnemyData=O;exports.readRmmzItemData=k;exports.readRmmzMapInfoData=K;exports.readRmmzSkillData=W;exports.readRmmzStateData=j;exports.readRmmzTroopData=x;exports.readRmmzWeaponData=$;exports.resolveMapFilePath=q;exports.writeDataFiles=rt;exports.writeRmmzActorData=p;exports.writeRmmzArmorData=v;exports.writeRmmzClassData=N;exports.writeRmmzCommonEventData=Z;exports.writeRmmzEnemyData=h;exports.writeRmmzItemData=P;exports.writeRmmzMapInfoData=L;exports.writeRmmzSkillData=g;exports.writeRmmzStateData=f;exports.writeRmmzTroopData=U;exports.writeRmmzWeaponData=J;
//# sourceMappingURL=rpg-folder.cjs.js.map
